<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <title>title</title>
    <link rel="stylesheet" type="text/css" href="../css/api.css"/>
    <!--<link rel="stylesheet" type="text/css" href="../css/header.css"/>-->
    <style>
    	* { margin:0; padding:0;
            outline: 0;
        }
		header {
             background-color: #60b034;
             border:0px;
             height: 50px;
        }
        html, body {
            height: 100%;
            width: 100%;
        }

        #wrap {
            height: 100%;
            display: -webkit-box;
            display: -webkit-flex;
            display: flex;
            -webkit-box-orient: vertical;
            -webkit-flex-flow: column;
            flex-flow: column;
        }
		#wrap {-webkit-animation: fadeIn .5s ease both;animation: fadeIn .5s ease both;}
    	input,button,select,textarea{outline:none;-webkit-appearance:none;}
    	/*.topzhong input{
    		background-color: #fff;
    		font-size:14px;
    		height:25px;
    		-webkit-box-flex: 1;
            -webkit-flex: 1;
            flex: 1;
            border-radius: 2px;
    	}*/
    	.ss{
    		border:1px solid #ff9393;
    		height:28px;
    		line-height: 28px;
    		margin: 10px 5px 0 0;
    		border-radius: 2px;
    		font-size:12px;
    	}
    	.di{
    		display: -webkit-box;
            display: -webkit-flex;
            display: flex;
            width:100%;
    		height:50px;
    	}
    	.di1{
    		display: -webkit-box;
            display: -webkit-flex;
            display: flex;
            background-color: #fff;
    		border-radius: 2px;
    		height:28px;
    		margin-top:9px;
    		width:95%;
    	}
    	.sousuo_icon{
    		width:20px;
    		background-image:url('../image/sousuo_hui.png');
    		background-repeat: no-repeat;
    		background-position: 2px 7px;
    		background-size: 16px 16px;
    		margin:0 3px;
    	}
    	.topbar {
            background: #60b034;
            height: 50px;
            line-height: 50px;
            text-align: center;
            /*display: none;*/
            color: #fff;
            font-size: 20px;
            font-weight: bold;
            position: relative;
        }
    	#goshop{
    		display: -webkit-box;
            display: -webkit-flex;
            display: flex;
    	}
    	.topzuo{
    		width: 50px;
            height:50px;
    		background-image:url('../image/return.png');
            background-size:11px 19px;
            background-repeat: no-repeat;
            background-position: 13px 15px;
    	}
    	.topzhong{
    		-webkit-box-flex: 1;
            -webkit-flex: 1;
            flex: 1;
            margin-right:10px;
    	}
    	.topyou{
    		width: 50px;
            height:50px;
            font-size: 15px;
    	}
    	.topzhong{
    		padding-top:10px;
    		padding-bottom:10px;
    	}
    	#di{
    		background-color:#fff;
    		border-radius:5px;
    		height:30px;
    		display: -webkit-box;
            display: -webkit-flex;
            display: flex;
            color:#000;
    	}
    	#z_l{
    		line-height: 30px;
    		font-size: 12px;
    		font-weight:normal;
    		padding:0 5px;
    	}
    	#z_r{
    		-webkit-box-flex: 1;
            -webkit-flex: 1;
            flex: 1;
            position: relative;
    	}
    	#z_r input{
    		width:100%;
    		height:30px;
    		margin:0;
    		line-height: 30px;
    		font-weight:normal;
    		padding:0;
    		position: absolute;
    		top:0;
    		left:0;
    		color:#000;
    		font-size: 12px;
    	}
    	.sanjiao{
            /*width: 0;
            height: 0;*/
            border-left: 4px solid transparent;
            border-right: 4px solid transparent;
            border-top: 4px solid #000;
            margin-left:5px;
            /*position: absolute;*/
            /*left: 50%;
            top:100%;
            margin-left: -4px;*/
        }
    </style>
</head>
<body>
<div id="wrap">
	<header id="headers">
        <div id="goshop" class="topbar ">
	        <div tapmode="a" onclick="freturn();fclose_sousuo_xuan_way();" class="topzuo"></div>
	        <div class="topzhong">
	        	<div id="di">
	        		<div id="z_l" onclick="fopen_xuan_way();">商品<span class="sanjiao"></span></div>
	        		<div id="z_r" onclick="fopen_ssy();">
	        			<input type="text" id="input" maxlength="20" placeholder="请输入搜索内容"/>
	        		</div>
	        	</div>
	        </div>
	      	<!--<div class="topzhong">
	      		<div class="di">
	      			<div class="di1">
	      				<div class="sousuo_icon" tapmode="" onclick="fgo();"></div>
	      				<input type="text" id="input" maxlength="20" placeholder="请输入商品名称" />
	      			</div>
	      		</div>
	      	</div>-->
	      	<div tapmode="a" class="topyou" onclick="fclose_sousuo_xuan_way();"><div class="ss" tapmode="" onclick="fgo();">搜索</div></div>
	      	<!--<div tapmode="a" class="topyou_tu" onclick="fopen_goshop();"></div>-->
        </div>
	</header>
</div>
</body>
<script type="text/javascript" src="../script/api.js"></script>
<script type="text/javascript" src="../script/jquery190.js"></script>
<script type="text/javascript">
var sousuo_way=0;
function freturn()
{
	api.closeWin({
    });
}
function fset_value(n)
{
	$('#input').val(n);
}
function fclose_sousuo_xuan_way()
{
	api.closeFrame({
	        name: 'sousuo_xuan_way'
    });
}
function fopen_xuan_way()
	    {
	    	$('#input').blur();
	    	var $header = $api.dom('header');
			$api.fixIos7Bar($header);
			var $body = $api.dom('body');
			var header_h = $api.offset($header).h;
			var body_h = $api.offset($body).h;
			var rect_h = api.winHeight - header_h;
			var h=42;
			if(api.pageParam.index==0) h=22;
	    	api.openFrame({
	            name: 'sousuo_xuan_way',
	            url: 'sousuo_xuan_way.html',
	            rect: {
		            x:50,
		            y:header_h-10,
		            w:47,
		            h:h
	            },
	            pageParam:{
	            	index:api.pageParam.index
	            }
            });
	    }
	    function fset_way(n)
	    {
	    	if(n==0)
	    	{
	    		sousuo_way=0;
	    		document.getElementById("z_l").innerHTML="微帮<span class='sanjiao'></span>";
	    	}
	    	else if(n==1)
	    	{
	    		sousuo_way=1;
	    		document.getElementById("z_l").innerHTML="帖子<span class='sanjiao'></span>";
	    	}
	    	else if(n==2)
	    	{
	    		sousuo_way=2;
	    		document.getElementById("z_l").innerHTML="店铺<span class='sanjiao'></span>";
	    	}
	    	else if(n==3)
	    	{
	    		sousuo_way=3;
	    		document.getElementById("z_l").innerHTML="商品<span class='sanjiao'></span>";
	    	}
	    }
	apiready = function(){
			api.parseTapmode();
		if(api.systemType=='ios'){
       		document.getElementById("headers").style.paddingTop="20px";
    	}
    	else
    	{
    		var sVer = api.systemVersion;
    		var banben=parseFloat(sVer);
    		if(banben>=4.4)
    		{
    			document.getElementById("headers").style.paddingTop="25px";
    		}
    	}
    	var num=Number($api.getStorage('sousuo_lishi_num'));
    	if(num>=0 && num<10);
    	else $api.setStorage('sousuo_lishi_num',0);
    	setTimeout("fopencontent()",200);
    	var index=api.pageParam.index;
    	if(index==0)
    	{
    		sousuo_way=0;
	    	document.getElementById("z_l").innerHTML="微帮<span class='sanjiao'></span>";
    	}
    	else if(index==1)
    	{
    		sousuo_way=2;
	    	document.getElementById("z_l").innerHTML="店铺<span class='sanjiao'></span>";
    	}
	};
	$('#input').bind('keyup', function(event) {
	        if (event.keyCode == "13") {
	            //回车执行查询
	            var value=document.getElementById("input").value;
	            if(value=='') return;
	            var num=Number($api.getStorage('sousuo_lishi_num'));
	            if(num<10)
	            {
	            	var pan=0;
	            	for(var i=0;i<num;i++)
	            	{
	            		var val=$api.getStorage('sousuo_lishi['+i+']');
	            		if(val==value) {pan=1;break;}
	            	}
	            	if(pan==0)
	            	{
		            	$api.setStorage('sousuo_lishi['+num+']',value);
		            	$api.setStorage('sousuo_lishi_num',Number(num)+1);
	            	}
	            	else
	            	{
	            		var t=-1;
	            		for(var i=0;i<num;i++)
	            		{
	            			val=$api.getStorage('sousuo_lishi['+i+']');
	            			if(val==value)
							{
								t=i;
							}
							if(i>=t && i!=(num-1) && t>=0)
							{
								val2=$api.getStorage('sousuo_lishi['+(i+1)+']');
	            				$api.setStorage('sousuo_lishi['+i+']',val2);
							}
	            		}
	            		$api.setStorage('sousuo_lishi['+(num-1)+']',value);
	            	}
	            	api.execScript({
	                   	frameName:'ssy2',
	                    script: 'fget_sousuo_lishi();'
                    });
	            }
	            else
	            {
	            	var pan=0;
	            	for(var i=0;i<num;i++)
	            	{
	            		var val=$api.getStorage('sousuo_lishi['+i+']');
	            		if(val==value) {pan=1;break;}
	            	}
	            	if(pan==0)
	            	{
		            	for(i=0;i<10;i++)
		            	{
		            		if(i==9)
		            		{
		            			$api.setStorage('sousuo_lishi['+i+']',value);
		            		}
		            		else
		            		{
		            			var val=$api.getStorage('sousuo_lishi['+(i+1)+']');
		            			$api.setStorage('sousuo_lishi['+i+']',val);
		            		}
		            	}
	            	}
	            	else
	            	{
	            		var t=-1;
	            		for(var i=0;i<num;i++)
	            		{
	            			val=$api.getStorage('sousuo_lishi['+i+']');
	            			if(val==value)
							{
								t=i;
							}
							if(i>=t && i!=(num-1) && t>=0)
							{
								val2=$api.getStorage('sousuo_lishi['+(i+1)+']');
	            				$api.setStorage('sousuo_lishi['+i+']',val2);
							}
							else
							{
								$api.setStorage('sousuo_lishi['+i+']',value);
							}
	            		}
	            	}
	            }

	            api.openWin({
		            name: 'sousuo_all_header',
		            url: 'sousuo_all_header.html',
		            pageParam:{
		            	text:value,
		            	sousuo_way:sousuo_way
		            },
		            reload:true
	            });

	        }
	    });
	    function fopen_sousuo()
	    {
	    	var value=document.getElementById("input").value;
	            if(value=='') return;
	            var num=Number($api.getStorage('sousuo_lishi_num'));
	            if(num<10)
	            {
	            	var pan=0;
	            	for(var i=0;i<num;i++)
	            	{
	            		var val=$api.getStorage('sousuo_lishi['+i+']');
	            		if(val==value) {pan=1;break;}
	            	}
	            	if(pan==0)
	            	{
		            	$api.setStorage('sousuo_lishi['+num+']',value);
		            	$api.setStorage('sousuo_lishi_num',Number(num)+1);
	            	}
	            	else
	            	{
	            		var t=-1;
	            		for(var i=0;i<num;i++)
	            		{
	            			val=$api.getStorage('sousuo_lishi['+i+']');
	            			if(val==value)
							{
								t=i;
							}
							if(i>=t && i!=(num-1) && t>=0)
							{
								val2=$api.getStorage('sousuo_lishi['+(i+1)+']');
	            				$api.setStorage('sousuo_lishi['+i+']',val2);
							}
	            		}
	            		$api.setStorage('sousuo_lishi['+(num-1)+']',value);
	            	}
	            	api.execScript({
	                   	frameName:'ssy2',
	                    script: 'fget_sousuo_lishi();'
                    });
	            }
	            else
	            {
	            	var pan=0;
	            	for(var i=0;i<num;i++)
	            	{
	            		var val=$api.getStorage('sousuo_lishi['+i+']');
	            		if(val==value) {pan=1;break;}
	            	}
	            	if(pan==0)
	            	{
		            	for(i=0;i<10;i++)
		            	{
		            		if(i==9)
		            		{
		            			$api.setStorage('sousuo_lishi['+i+']',value);
		            		}
		            		else
		            		{
		            			var val=$api.getStorage('sousuo_lishi['+(i+1)+']');
		            			$api.setStorage('sousuo_lishi['+i+']',val);
		            		}
		            	}
	            	}
	            	else
	            	{
	            		var t=-1;
	            		for(var i=0;i<num;i++)
	            		{
	            			val=$api.getStorage('sousuo_lishi['+i+']');
	            			if(val==value)
							{
								t=i;
							}
							if(i>=t && i!=(num-1) && t>=0)
							{
								val2=$api.getStorage('sousuo_lishi['+(i+1)+']');
	            				$api.setStorage('sousuo_lishi['+i+']',val2);
							}
							else
							{
								$api.setStorage('sousuo_lishi['+i+']',value);
							}
	            		}
	            	}
	            }

	            api.openWin({
		            name: 'sousuo_all_header',
		            url: 'sousuo_all_header.html',
		            pageParam:{
		            	text:value,
		            	sousuo_way:sousuo_way
		            },
		            reload:true
	            });

	    }
	    function fgo()
	    {
	    	fopen_sousuo();
	    }
	    function fset(n)
	    {
	    	document.getElementById("input").value=n;
	    	fopen_sousuo();
	    }
function fopencontent()
{
	var $header = $api.dom('header');
			$api.fixIos7Bar($header);
			var $body = $api.dom('body');
			var header_h = $api.offset($header).h;
			var body_h = $api.offset($body).h;
			var rect_h = api.winHeight - header_h;

	    	api.openFrame({
		        name: 'ssy2',
		        url: 'ssy2.html',
		        vScrollBarEnabled:false,
            	hScrollBarEnabled:false,
            	bounces:true,
		        rect: {
			        x : 0,
					y : header_h,
					w : 'auto',
					h : rect_h
		        },
		        bgColor:"#f2f2f2",
		        pageParam:{
		        	index:api.pageParam.index
		        }
	        });
}
function fopen_goshop()
	{
		api.closeWin({name:'bimaizhuanqu_header'});
		api.closeWin({name:'chaoshi_header'});
		api.closeWin({name:'dingdan_header'});
		api.closeWin({name:'dingdan_xx_header'});
		api.closeWin({name:'fenlei_header'});
		api.closeWin({name:'fuzhuangcheng_header'});
		api.closeWin({name:'miaosha_header'});
		api.closeWin({name:'tuangou_header'});
		api.closeWin({name:'wuliu_xx_header'});
		api.execScript({
			name:'root',
	        script: 'randomSwitchBtn("","goshop",3);'
        });
        api.closeWin({name:'goods_header'});
	}
</script>
</html>
